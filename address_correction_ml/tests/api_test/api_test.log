2025-04-20 22:50:37.0249 [    INFO] address_correction_ml.tests.api_test.conftest --- Test run starting, logging to /home/user/projects/address_correction_ml/src/address_correction_ml/tests/api_test/api_test.log ---
2025-04-20 22:50:37.0557 [    INFO] root                 Starting test 'test_metrics' with trace_parent: 00-2476ce79d4554815a401167375cc8ee9-f9ac06df56194b73-01
2025-04-20 22:50:37.0558 [    INFO] maxitest.restapi.service request : {"method":"get","host":"http://host.docker.internal:8080","path":"/api/v1/metrics","headers":{"traceparent":"00-2476ce79d4554815a401167375cc8ee9-f9ac06df56194b73-01"},"params":{},"body":null}
2025-04-20 22:50:37.0569 [    INFO] maxitest.restapi.service response: {"status_code":200,"status_msg":"OK","headers":{"date":"Sun, 20 Apr 2025 19:50:36 GMT","server":"uvicorn","content-length":"9211","content-type":"text/plain; version=0.0.4; charset=utf-8"},"encoding":"utf-8","body":"# HELP exception_counter_total Number of exceptions during prediction\n# TYPE exception_counter_total counter\nexception_counter_total 0.0\n# HELP starlette_requests_total Total HTTP requests\n# TYPE starlette_requests_total counter\nstarlette_requests_total{app_name=\"name service\",method=\"POST\",path=\"/api/v1/predict\",status_code=\"200\"} 25.0\nstarlette_requests_total{app_name=\"name service\",method=\"GET\",path=\"/api/v1/metrics\",status_code=\"200\"} 18.0\nstarlette_requests_total{app_name=\"name service\",method=\"GET\",path=\"/api/v1/ping\",status_code=\"200\"} 18.0\n# HELP starlette_requests_in_progress Total HTTP requests currently in progress\n# TYPE starlette_requests_in_progress gauge\nstarlette_requests_in_progress{app_name=\"name service\",method=\"POST\"} 0.0\nstarlette_requests_in_progress{app_name=\"name service\",method=\"GET\"} 1.0\n# HELP predict_time Time spent processing predicttions\n# TYPE predict_time histogram\npredict_time_sum{endpoint=\"/predict\",method=\"predict_route\"} 79.55254549806705\npredict_time_bucket{endpoint=\"/predict\",le=\"0.005\",method=\"predict_route\"} 0.0\npredict_time_bucket{endpoint=\"/predict\",le=\"0.01\",method=\"predict_route\"} 0.0\npredict_time_bucket{endpoint=\"/predict\",le=\"0.025\",method=\"predict_route\"} 0.0\npredict_time_bucket{endpoint=\"/predict\",le=\"0.05\",method=\"predict_route\"} 0.0\npredict_time_bucket{endpoint=\"/predict\",le=\"0.075\",method=\"predict_route\"} 0.0\npredict_time_bucket{endpoint=\"/predict\",le=\"0.1\",method=\"predict_route\"} 0.0\npredict_time_bucket{endpoint=\"/predict\",le=\"0.25\",method=\"predict_route\"} 0.0\npredict_time_bucket{endpoint=\"/predict\",le=\"0.5\",method=\"predict_route\"} 0.0\npredict_time_bucket{endpoint=\"/predict\",le=\"0.75\",method=\"predict_route\"} 0.0\npredict_time_bucket{endpoint=\"/predict\",le=\"1.0\",method=\"predict_route\"} 0.0\npredict_time_bucket{endpoint=\"/predict\",le=\"2.5\",method=\"predict_route\"} 8.0\npredict_time_bucket{endpoint=\"/predict\",le=\"5.0\",method=\"predict_route\"} 24.0\npredict_time_bucket{endpoint=\"/predict\",le=\"7.5\",method=\"predict_route\"} 24.0\npredict_time_bucket{endpoint=\"/predict\",le=\"10.0\",method=\"predict_route\"} 25.0\npredict_time_bucket{endpoint=\"/predict\",le=\"+Inf\",method=\"predict_route\"} 25.0\npredict_time_count{endpoint=\"/predict\",method=\"predict_route\"} 25.0\n# HELP starlette_request_duration_seconds HTTP request duration, in seconds\n# TYPE starlette_request_duration_seconds histogram\nstarlette_request_duration_seconds_sum{app_name=\"name service\",method=\"POST\",path=\"/api/v1/predict\",status_code=\"200\"} 79.61399205884663\nstarlette_request_duration_seconds_sum{app_name=\"name service\",method=\"GET\",path=\"/api/v1/metrics\",status_code=\"200\"} 0.062019354198127985\nstarlette_request_duration_seconds_sum{app_name=\"name service\",method=\"GET\",path=\"/api/v1/ping\",status_code=\"200\"} 0.027551374107133597\nstarlette_request_duration_seconds_bucket{app_name=\"name service\",le=\"0.005\",method=\"POST\",path=\"/api/v1/predict\",status_code=\"200\"} 0.0\nstarlette_request_duration_seconds_bucket{app_name=\"name service\",le=\"0.01\",method=\"POST\",path=\"/api/v1/predict\",status_code=\"200\"} 0.0\nstarlette_request_duration_seconds_bucket{app_name=\"name service\",le=\"0.025\",method=\"POST\",path=\"/api/v1/predict\",status_code=\"200\"} 0.0\nstarlette_request_duration_seconds_bucket{app_name=\"name service\",le=\"0.05\",method=\"POST\",path=\"/api/v1/predict\",status_code=\"200\"} 0.0\nstarlette_request_duration_seconds_bucket{app_name=\"name service\",le=\"0.075\",method=\"POST\",path=\"/api/v1/predict\",status_code=\"200\"} 0.0\nstarlette_request_duration_seconds_bucket{app_name=\"name service\",le=\"0.1\",method=\"POST\",path=\"/api/v1/predict\",status_code=\"200\"} 0.0\nstarlette_request_duration_seconds_bucket{app_name=\"name service\",le=\"0.25\",method=\"POST\",path=\"/api/v1/predict\",status_code=\"200\"} 0.0\nstarlette_request_duration_seconds_bucket{app_name=\"name service\",le=\"0.5\",method=\"POST\",path=\"/api/v1/predict\",status_code=\"200\"} 0.0\nstarlette_request_duration_seconds_bucket{app_name=\"name service\",le=\"0.75\",method=\"POST\",path=\"/api/v1/predict\",status_code=\"200\"} 0.0\nstarlette_request_duration_seconds_bucket{app_name=\"name service\",le=\"1.0\",method=\"POST\",path=\"/api/v1/predict\",status_code=\"200\"} 0.0\nstarlette_request_duration_seconds_bucket{app_name=\"name service\",le=\"2.5\",method=\"POST\",path=\"/api/v1/predict\",status_code=\"200\"} 8.0\nstarlette_request_duration_seconds_bucket{app_name=\"name service\",le=\"5.0\",method=\"POST\",path=\"/api/v1/predict\",status_code=\"200\"} 24.0\nstarlette_request_duration_seconds_bucket{app_name=\"name service\",le=\"7.5\",method=\"POST\",path=\"/api/v1/predict\",status_code=\"200\"} 24.0\nstarlette_request_duration_seconds_bucket{app_name=\"name service\",le=\"10.0\",method=\"POST\",path=\"/api/v1/predict\",status_code=\"200\"} 25.0\nstarlette_request_duration_seconds_bucket{app_name=\"name service\",le=\"+Inf\",method=\"POST\",path=\"/api/v1/predict\",status_code=\"200\"} 25.0\nstarlette_request_duration_seconds_count{app_name=\"name service\",method=\"POST\",path=\"/api/v1/predict\",status_code=\"200\"} 25.0\nstarlette_request_duration_seconds_bucket{app_name=\"name service\",le=\"0.005\",method=\"GET\",path=\"/api/v1/metrics\",status_code=\"200\"} 17.0\nstarlette_request_duration_seconds_bucket{app_name=\"name service\",le=\"0.01\",method=\"GET\",path=\"/api/v1/metrics\",status_code=\"200\"} 18.0\nstarlette_request_duration_seconds_bucket{app_name=\"name service\",le=\"0.025\",method=\"GET\",path=\"/api/v1/metrics\",status_code=\"200\"} 18.0\nstarlette_request_duration_seconds_bucket{app_name=\"name service\",le=\"0.05\",method=\"GET\",path=\"/api/v1/metrics\",status_code=\"200\"} 18.0\nstarlette_request_duration_seconds_bucket{app_name=\"name service\",le=\"0.075\",method=\"GET\",path=\"/api/v1/metrics\",status_code=\"200\"} 18.0\nstarlette_request_duration_seconds_bucket{app_name=\"name service\",le=\"0.1\",method=\"GET\",path=\"/api/v1/metrics\",status_code=\"200\"} 18.0\nstarlette_request_duration_seconds_bucket{app_name=\"name service\",le=\"0.25\",method=\"GET\",path=\"/api/v1/metrics\",status_code=\"200\"} 18.0\nstarlette_request_duration_seconds_bucket{app_name=\"name service\",le=\"0.5\",method=\"GET\",path=\"/api/v1/metrics\",status_code=\"200\"} 18.0\nstarlette_request_duration_seconds_bucket{app_name=\"name service\",le=\"0.75\",method=\"GET\",path=\"/api/v1/metrics\",status_code=\"200\"} 18.0\nstarlette_request_duration_seconds_bucket{app_name=\"name service\",le=\"1.0\",method=\"GET\",path=\"/api/v1/metrics\",status_code=\"200\"} 18.0\nstarlette_request_duration_seconds_bucket{app_name=\"name service\",le=\"2.5\",method=\"GET\",path=\"/api/v1/metrics\",status_code=\"200\"} 18.0\nstarlette_request_duration_seconds_bucket{app_name=\"name service\",le=\"5.0\",method=\"GET\",path=\"/api/v1/metrics\",status_code=\"200\"} 18.0\nstarlette_request_duration_seconds_bucket{app_name=\"name service\",le=\"7.5\",method=\"GET\",path=\"/api/v1/metrics\",status_code=\"200\"} 18.0\nstarlette_request_duration_seconds_bucket{app_name=\"name service\",le=\"10.0\",method=\"GET\",path=\"/api/v1/metrics\",status_code=\"200\"} 18.0\nstarlette_request_duration_seconds_bucket{app_name=\"name service\",le=\"+Inf\",method=\"GET\",path=\"/api/v1/metrics\",status_code=\"200\"} 18.0\nstarlette_request_duration_seconds_count{app_name=\"name service\",method=\"GET\",path=\"/api/v1/metrics\",status_code=\"200\"} 18.0\nstarlette_request_duration_seconds_bucket{app_name=\"name service\",le=\"0.005\",method=\"GET\",path=\"/api/v1/ping\",status_code=\"200\"} 18.0\nstarlette_request_duration_seconds_bucket{app_name=\"name service\",le=\"0.01\",method=\"GET\",path=\"/api/v1/ping\",status_code=\"200\"} 18.0\nstarlette_request_duration_seconds_bucket{app_name=\"name service\",le=\"0.025\",method=\"GET\",path=\"/api/v1/ping\",status_code=\"200\"} 18.0\nstarlette_request_duration_seconds_bucket{app_name=\"name service\",le=\"0.05\",method=\"GET\",path=\"/api/v1/ping\",status_code=\"200\"} 18.0\nstarlette_request_duration_seconds_bucket{app_name=\"name service\",le=\"0.075\",method=\"GET\",path=\"/api/v1/ping\",status_code=\"200\"} 18.0\nstarlette_request_duration_seconds_bucket{app_name=\"name service\",le=\"0.1\",method=\"GET\",path=\"/api/v1/ping\",status_code=\"200\"} 18.0\nstarlette_request_duration_seconds_bucket{app_name=\"name service\",le=\"0.25\",method=\"GET\",path=\"/api/v1/ping\",status_code=\"200\"} 18.0\nstarlette_request_duration_seconds_bucket{app_name=\"name service\",le=\"0.5\",method=\"GET\",path=\"/api/v1/ping\",status_code=\"200\"} 18.0\nstarlette_request_duration_seconds_bucket{app_name=\"name service\",le=\"0.75\",method=\"GET\",path=\"/api/v1/ping\",status_code=\"200\"} 18.0\nstarlette_request_duration_seconds_bucket{app_name=\"name service\",le=\"1.0\",method=\"GET\",path=\"/api/v1/ping\",status_code=\"200\"} 18.0\nstarlette_request_duration_seconds_bucket{app_name=\"name service\",le=\"2.5\",method=\"GET\",path=\"/api/v1/ping\",status_code=\"200\"} 18.0\nstarlette_request_duration_seconds_bucket{app_name=\"name service\",le=\"5.0\",method=\"GET\",path=\"/api/v1/ping\",status_code=\"200\"} 18.0\nstarlette_request_duration_seconds_bucket{app_name=\"name service\",le=\"7.5\",method=\"GET\",path=\"/api/v1/ping\",status_code=\"200\"} 18.0\nstarlette_request_duration_seconds_bucket{app_name=\"name service\",le=\"10.0\",method=\"GET\",path=\"/api/v1/ping\",status_code=\"200\"} 18.0\nstarlette_request_duration_seconds_bucket{app_name=\"name service\",le=\"+Inf\",method=\"GET\",path=\"/api/v1/ping\",status_code=\"200\"} 18.0\nstarlette_request_duration_seconds_count{app_name=\"name service\",method=\"GET\",path=\"/api/v1/ping\",status_code=\"200\"} 18.0\n"}
2025-04-20 22:50:37.0571 [    INFO] root                 Finishing test 'test_metrics'. Clearing
2025-04-20 22:50:37.0574 [    INFO] root                 Starting test 'test_triton_model_readiness[mbart_address_correction_onnx_export_optimum]' with trace_parent: 00-498f19751fd64e5ba0575f51f73ceee7-ee10c2e66bb948b4-01
2025-04-20 22:50:37.0577 [    INFO] maxitest.restapi.service request : {"method":"post","host":"http://host.docker.internal:8000","path":"/v2/repository/index","headers":{"traceparent":"00-498f19751fd64e5ba0575f51f73ceee7-ee10c2e66bb948b4-01","Content-Length":"2","Content-Type":"application/json"},"params":{},"body":{}}
2025-04-20 22:50:37.0584 [    INFO] maxitest.restapi.service response: {"status_code":200,"status_msg":"OK","headers":{"Content-Type":"application/json","Content-Length":"87"},"encoding":"utf-8","body":"[{\"name\":\"mbart_address_correction_onnx_export_optimum\",\"version\":\"1\",\"state\":\"READY\"}]"}
2025-04-20 22:50:37.0586 [    INFO] root                 Finishing test 'test_triton_model_readiness[mbart_address_correction_onnx_export_optimum]'. Clearing
2025-04-20 22:50:37.0590 [    INFO] root                 Starting test 'test_ping' with trace_parent: 00-7e4517b6bb4d4a87966c672c787d1e48-147e887f6fb54b42-01
2025-04-20 22:50:37.0591 [    INFO] maxitest.restapi.service request : {"method":"get","host":"http://host.docker.internal:8080","path":"/api/v1/ping","headers":{"traceparent":"00-7e4517b6bb4d4a87966c672c787d1e48-147e887f6fb54b42-01"},"params":{},"body":null}
2025-04-20 22:50:37.0602 [    INFO] maxitest.restapi.service response: {"status_code":200,"status_msg":"OK","headers":{"date":"Sun, 20 Apr 2025 19:50:37 GMT","server":"uvicorn","content-length":"18","content-type":"application/json"},"encoding":"utf-8","body":"{\"message\":\"pong\"}"}
2025-04-20 22:50:37.0604 [    INFO] root                 Finishing test 'test_ping'. Clearing
2025-04-20 22:50:37.0608 [    INFO] root                 Starting test 'test_predict_single_success' with trace_parent: 00-87c0c9f3d98e4a328532a43791812bb6-34d68f50a7484d95-01
2025-04-20 22:50:37.0611 [    INFO] maxitest.restapi.service request : {"method":"post","host":"http://host.docker.internal:8080","path":"/api/v1/predict","headers":{"traceparent":"00-87c0c9f3d98e4a328532a43791812bb6-34d68f50a7484d95-01","Content-Length":"146","Content-Type":"application/json"},"params":{},"body":{"request_id":"test_ok-9uNxBz","geoparser_address":"Geoparser Address GyKjtW3nwVbdohVThYJZ","old_address":"Old Address 3xvGMmb7td1xnobWfi22"}}
2025-04-20 22:50:40.0768 [    INFO] maxitest.restapi.service response: {"status_code":200,"status_msg":"OK","headers":{"date":"Sun, 20 Apr 2025 19:50:37 GMT","server":"uvicorn","content-length":"100","content-type":"application/json"},"encoding":"utf-8","body":"{\"id\":\"test_ok-9uNxBz\",\"corrected_address\":\"Geo-Garant74 автосервис\",\"error_message\":null}"}
2025-04-20 22:50:40.0770 [    INFO] root                 Finishing test 'test_predict_single_success'. Clearing
